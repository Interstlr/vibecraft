<div class="inventory-overlay" (contextmenu)="onContextMenu($event)">
  <div class="inventory-window">
    
    <!-- Crafting Area -->
    <div class="crafting-container">
        <div class="section-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 4px;">
             <div class="section-label">Crafting</div>
             <button (click)="toggleGridSize()" style="font-size:10px; cursor:pointer; background: #8b8b8b; border: 1px solid #373737; color: white;">
                {{ inventoryService.craftingGridSize() }}x{{ inventoryService.craftingGridSize() }}
             </button>
        </div>
        <div class="crafting-flex">
            <div class="crafting-grid" 
                 [style.grid-template-columns]="'repeat(' + inventoryService.craftingGridSize() + ', 36px)'"
                 [style.grid-template-rows]="'repeat(' + inventoryService.craftingGridSize() + ', 36px)'">
                <div class="slot" *ngFor="let i of craftingIndices()" 
                    (mousedown)="onSlotClick(i, $event)">
                    <div class="item-icon" *ngIf="inventoryService.getSlot(i).item as item"
                        [style.background-image]="getSlotImage(item) ? 'url(' + getSlotImage(item) + ')' : null"
                        [style.background-color]="getSlotColor(item)">
                    </div>
                    <div class="item-count" *ngIf="inventoryService.getSlot(i).count > 1">
                        {{ inventoryService.getSlot(i).count }}
                    </div>
                </div>
            </div>
            <div class="crafting-arrow">âž”</div>
            <div class="slot result-slot" (mousedown)="onSlotClick(resultSlotIndex(), $event)">
                <div class="item-icon" *ngIf="inventoryService.getSlot(resultSlotIndex()).item as item"
                    [style.background-image]="getSlotImage(item) ? 'url(' + getSlotImage(item) + ')' : null"
                    [style.background-color]="getSlotColor(item)">
                </div>
                <div class="item-count" *ngIf="inventoryService.getSlot(resultSlotIndex()).count > 1">
                    {{ inventoryService.getSlot(resultSlotIndex()).count }}
                </div>
            </div>
        </div>
    </div>

    <!-- Main Inventory -->
    <div class="inventory-container">
        <div class="section-label">Inventory</div>
        <div class="inventory-grid">
            <!-- Range 9-35 -->
            <ng-container *ngFor="let i of [
                9,10,11,12,13,14,15,16,17,
                18,19,20,21,22,23,24,25,26,
                27,28,29,30,31,32,33,34,35
            ]">
                <div class="slot" (mousedown)="onSlotClick(i, $event)">
                    <div class="item-icon" *ngIf="inventoryService.getSlot(i).item as item"
                        [style.background-image]="getSlotImage(item) ? 'url(' + getSlotImage(item) + ')' : null"
                        [style.background-color]="getSlotColor(item)">
                    </div>
                    <div class="item-count" *ngIf="inventoryService.getSlot(i).count > 1">
                        {{ inventoryService.getSlot(i).count }}
                    </div>
                </div>
            </ng-container>
        </div>
    </div>

    <!-- Hotbar -->
    <div class="hotbar-container">
        <div class="inventory-grid">
            <ng-container *ngFor="let i of [0,1,2,3,4,5,6,7,8]">
                <div class="slot" 
                     [class.selected-hotbar]="i === inventoryService.selectedHotbarIndex()"
                     (mousedown)="onSlotClick(i, $event)">
                    <div class="item-icon" *ngIf="inventoryService.getSlot(i).item as item"
                        [style.background-image]="getSlotImage(item) ? 'url(' + getSlotImage(item) + ')' : null"
                        [style.background-color]="getSlotColor(item)">
                    </div>
                    <div class="item-count" *ngIf="inventoryService.getSlot(i).count > 1">
                        {{ inventoryService.getSlot(i).count }}
                    </div>
                </div>
            </ng-container>
        </div>
    </div>

  </div>

  <!-- Held Item -->
  <div class="held-item" *ngIf="inventoryService.heldItem().item"
       [style.left.px]="mouseX()" 
       [style.top.px]="mouseY()">
       <div class="item-icon"
            [style.background-image]="getSlotImage(inventoryService.heldItem().item) ? 'url(' + getSlotImage(inventoryService.heldItem().item) + ')' : null"
            [style.background-color]="getSlotColor(inventoryService.heldItem().item)">
       </div>
       <div class="item-count" *ngIf="inventoryService.heldItem().count > 1">
         {{ inventoryService.heldItem().count }}
       </div>
  </div>
</div>
